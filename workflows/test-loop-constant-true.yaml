version: 2
metadata:
  name: Loop with Constant True
  description: Loop continues until max iterations
nodes:
  - id: trigger
    type: trigger
    position:
      x: 50
      "y": 150
    data:
      nodeType: trigger
      label: Start
      triggerType: manual
      outputs:
        - name: timestamp
          type: string
        - name: type
          type: string
        - name: text
          type: string
        - name: params
          type: json
  - id: loop
    type: loop
    position:
      x: 200
      "y": 100
    style:
      width: 400
      height: 250
    data:
      nodeType: loop
      label: Always Loop
      maxIterations: 3
      inputs:
        - name: trigger
          type: string
          required: false
      dockSlots:
        - name: iteration
          type: iteration
          valueType: number
        - name: continue
          type: continue
          valueType: boolean
  - id: keep-going
    type: constant
    parentId: loop
    position:
      x: 50
      "y": 50
    data:
      nodeType: constant
      label: Keep Going
      valueType: boolean
      value: true
      outputs:
        - name: value
          type: boolean
  - id: log
    type: shell
    parentId: loop
    position:
      x: 200
      "y": 50
    data:
      nodeType: shell
      label: Log Iteration
      script: echo "Iteration {{ inputs.i }}"
      inputs:
        - name: i
          type: number
        - name: input
          type: any
          required: false
          description: Generic input for template interpolation
      outputs:
        - name: output
          type: string
          description: Combined stdout output
        - name: stdout
          type: string
          description: Standard output
        - name: stderr
          type: string
          description: Standard error
        - name: exitCode
          type: number
          description: Exit code (0 = success)
edges:
  - id: trigger-to-loop
    source: trigger
    target: loop
    sourceHandle: output:text
    targetHandle: input:trigger
  - id: iter-to-log
    source: loop
    target: log
    sourceHandle: dock:iteration:output
    targetHandle: input:i
  - id: const-to-continue
    source: keep-going
    target: loop
    sourceHandle: output:value
    targetHandle: dock:continue:input
