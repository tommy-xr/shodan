version: 2
metadata:
  name: Phase 2 I/O Test
  description: Test workflow for Phase 2 input/output system

nodes:
  - id: trigger-1
    type: trigger
    position: { x: 100, y: 100 }
    data:
      label: Manual Trigger
      nodeType: trigger
      triggerType: manual

  - id: shell-1
    type: shell
    position: { x: 300, y: 100 }
    data:
      label: Test stdout/stderr
      nodeType: shell
      script: |
        echo "This is stdout output"
        echo "This is stderr output" >&2
        echo "Exit code will be 0"

  - id: shell-2
    type: shell
    position: { x: 500, y: 100 }
    data:
      label: Use trigger text
      nodeType: shell
      script: |
        echo "Received from trigger: {{ input }}"

  - id: shell-3
    type: shell
    position: { x: 700, y: 100 }
    data:
      label: Use shell stdout
      nodeType: shell
      script: |
        echo "Previous stdout was:"
        echo "{{ input }}"

  - id: shell-4
    type: shell
    position: { x: 900, y: 100 }
    data:
      label: Final output
      nodeType: shell
      script: |
        echo "Received from previous shell:"
        echo "{{ input }}"
        echo "All tests passed!"

edges:
  - id: e1
    source: trigger-1
    target: shell-1
    sourceHandle: output:text
    targetHandle: input:input

  - id: e2
    source: trigger-1
    target: shell-2
    sourceHandle: output:text
    targetHandle: input:input

  - id: e3
    source: shell-1
    target: shell-3
    sourceHandle: output:stdout
    targetHandle: input:input

  - id: e4
    source: shell-3
    target: shell-4
    sourceHandle: output:stdout
    targetHandle: input:input
